<!DOCTYPE HTML>
<html>
<head>
<META charset="UTF-8">
<title>[JUI Library] - JavaScript/Table/API</title>

<link href="//rawgit.com/juijs/jui/develop/dist/ui.css" rel="stylesheet" />
<link href="//rawgit.com/juijs/jui/develop/dist/ui-jennifer.css" rel="stylesheet" />
<script src="../../dist/core.js"></script>

<script>
    jui.defineUI("ui.button", [ "util.dom", "util.base" ], function($, _) {

        var UIRadio = function(ui, element, options) {
            this.data = { index: 0, value: "", elem: null };

            this.ui = ui;
            this.element = element;
            this.options = _.extend({ index: 0, value: "" }, options);

            // Private
            this._setting = function(type, e, order) {
                var self = this,
                    className = "active",
                    index = this.options.index,
                    value = this.options.value;

                $(self.element).children(".btn").each(function(i) {
                    if(type == "event") {
                        if(e.currentTarget == this) on(i, this);
                        else off(this);
                    } else if(type == "init") {
                        if(order == "value") {
                            if(value == $(this).attr("value")) on(i, this);
                            else off(this);
                        } else {
                            if(index == i) on(i, this);
                            else off(this);
                        }
                    }
                });

                function on(i, elem) {
                    var value = $(elem).attr("value"),
                        text = $(elem).text();

                    self.data = { index: i, value: value, text: text };
                    $(elem).addClass(className);
                }

                function off(elem) {
                    $(elem).removeClass(className);
                }
            }


            this.init = function() {
                var self = this;

                // Event
                this.ui.addEvent($(self.element).children(".btn"), "click", function(e) {
                    self._setting("event", e);

                    self.ui.emit("click", [ self.data, e ]);
                    self.ui.emit("change", [ self.data, e ]);

                    e.preventDefault();
                });

                // Init
                if(this.options.value != "") {
                    this._setting("init", this.options.value, "value");
                } else {
                    this._setting("init", this.options.index, "index");
                }
            }
        }

        var UICheck = function() {
            this.data = [];
            this.options = $.extend({ index: [], value: [] }, this.options);

            this._setting = function(type, e, order) {
                var self = this,
                    className = "active",
                    index = this.options.index,
                    value = this.options.value;

                $(self.element).children(".btn").each(function(i) {
                    if(type == "init") {
                        if(order == "value") {
                            if(inArray(value, $(this).attr("value"))) on(i, this);
                            else off(i, this);
                        } else {
                            if(inArray(index, i)) on(i, this);
                            else off(i, this);
                        }
                    } else {
                        if(e.currentTarget == this) {
                            if(!$(this).hasClass("active")) on(i, this);
                            else off(i, this);
                        }
                    }
                });

                function on(i, elem) {
                    var value = $(elem).attr("value"),
                        text = $(elem).text();

                    self.data[i] = { index: i, value: value, text: text };
                    $(elem).addClass(className);
                }

                function off(i, elem) {
                    self.data[i] = null;
                    $(elem).removeClass(className);
                }

                function inArray(arr, val) {
                    for(var i = 0; i < arr.length; i++) {
                        if(arr[i] == val) return true;
                    }

                    return false;
                }
            }
        }

        /**
         * @class ui.button
         * @extends core
         * @alias Button
         * @requires jquery
         * @requires util.base
         */
        var UI = function() {
            var ui_list = {};

            this.init = function() {
                var self = this, opts = this.options;

                if(opts.type == "radio") {
                    ui_list[opts.type] = new UIRadio(self, this.root, self.options);
                    ui_list[opts.type].init();
                } else if(opts.type == "check") {
                    UICheck.prototype = new UIRadio(self, this.root, self.options);

                    ui_list[opts.type] = new UICheck();
                    ui_list[opts.type].init();
                }
            }

            /**
             * @method setIndex
             * Selects a button of a specified index
             *
             * @param {Array} indexList Index for button check
             */
            this.setIndex = function(indexList) {
                var btn = ui_list[this.options.type];

                btn.options.index = indexList;
                btn._setting("init", null, "index");

                this.emit("change", [ btn.data ]);
            }

            /**
             * @method setValue
             * Selects a button with a specified value
             *
             * @param {Array} valueList Values for button check
             */
            this.setValue = function(valueList) {
                var btn = ui_list[this.options.type];

                btn.options.value = valueList;
                btn._setting("init", null, "value");

                this.emit("change", [ btn.data ]);
            }

            /**
             * @method getData
             * Gets the data of the button currently selected
             *
             * @return {Array}
             */
            this.getData = function() {
                return ui_list[this.options.type].data;
            }

            /**
             * @method getValue
             * Gets the value of the button currently selected
             *
             * @return {Array} Values
             * @return {Object} Value
             */
            this.getValue = function() {
                var data = this.getData();

                if(_.typeCheck("array", data)) { // 타입이 체크일 경우
                    var values = [];

                    for(var i = 0; i < data.length; i++) {
                        values[i] = (data[i] != null) ? data[i].value : data[i];
                    }

                    return values;
                }

                return data.value;
            }

            /**
             * @method reload
             * Re-defines the button UI
             */
            this.reload = function() {
                ui_list[this.options.type]._setting("init");
            }
        }

        UI.setup = function() {
            return {
                /**
                 * @cfg {String} [type="radio"]
                 * Determines whether to use a radio/check button
                 */
                type: "radio",

                /**
                 * @cfg {Integer} [index=0]
                 * Determines an initial selection button with a specified index
                 */
                index: 0,

                /**
                 * @cfg {String} [index=""]
                 * Determines an initial selection button with a specified value
                 */
                value: ""
            }
        }

        /**
         * @event change
         * Event that occurs when clicking on a button
         *
         * @param {Object} data Data of the selected button
         * @param {jQueryEvent} e The event object
         */

        /**
         * @event click
         * Event that occurs when clicking on a button
         *
         * @param {Object} data Data of the selected button
         * @param {jQueryEvent} e The event object
         */

        return UI;
    });

    jui.ready([ "ui.button" ], function(button) {
        var btn_radio_options = {
            type: "radio",
            event: {
                change: function(data) {
                    alert("index(" + data.index + "), value(" + data.value + ")");
                }
            }
        };

        var btn_check_options = {
            type: "check",
            event: {
                change: function(data) {
                    var result = "";

                    for(var i = 0; i < data.length; i++) {
                        if(data[i] != null) {
                            result += "index(" + data[i].index + "), value(" + data[i].value + ")" + "\n";
                        }
                    }

                    alert(result);
                }
            }
        };

        // 버튼-라디오
        btn_radio_1 = button("#btn_radio_1", btn_radio_options);
        btn_radio_2 = button("#btn_radio_2", btn_radio_options);
        btn_radio_3 = button("#btn_radio_3", btn_radio_options);

        // 버튼-체크
        btn_check = button("#btn_check", btn_check_options);
        btn_check_2 = button("#btn_check_2", btn_check_options);
    });
</script>

</head>
<body class="jui">

<div class="page-header">
    <h1>Button</h1>
</div>

<section>
    <h2>Radio</h2>
    <p>
        버튼 컴포넌트는 하나만 선택할 수 있는 라디오 타입을 제공합니다.

    <table class="table_s" width="100%" cellpadding="0" cellspacing="0">
        <tr>
            <td width="200px">View</td>
            <td width="75px">Result</td>
            <td>Test Code</td>
            <td>Description</td>
        </tr>
        <tr>
            <td>
                <div id="btn_radio_1" class="group">
                    <a class="btn small" value="true">On</a>
                    <a class="btn small" value="false">Off</a>
                </div>
            </td>
            <td>
                <button class="btn btn-gray" onclick="alert(btn_radio_1.getValue())"><i class="icon-play"></i> Run</button>
            </td>
            <td>
                alert(btn_radio_1.getValue());
            </td>
            <td>
                현재 선택된 버튼의 값을 출력
            </td>
        </tr>
        <tr>
            <td>
                <div id="btn_radio_2" class="group">
                    <a class="btn mini" value="a">A</a>
                    <a class="btn mini" value="b">B</a>
                    <a class="btn mini" value="c">C</a>
                    <a class="btn mini" value="home"><i class="icon-home"></i> Home</a>
                    <a class="btn mini" value="gear"><i class="icon-gear"></i></a>
                    <a class="btn mini" value="help"><i class="icon-help"></i></a>
                </div>
            </td>
            <td>
                <button class="btn btn-gray" onclick="btn_radio_2.setIndex(3);"><i class="icon-play"></i> Run</button>
            </td>
            <td>
                btn_radio_2.setIndex(3);
            </td>
            <td>
                해당 인덱스의 버튼을 선택 상태로 변경
            </td>
        </tr>
        <tr>
            <td>
                <div id="btn_radio_3" class="group">
                    <a class="btn mini" value="a">A</a>
                    <a class="btn mini" value="b">B</a>
                    <a class="btn mini" value="c">C</a>
                    <a class="btn mini" value="home"><i class="icon-home icon-white"></i></a>
                    <a class="btn mini" value="gear"><i class="icon-gear icon-white"></i></a>
                    <a class="btn mini" value="help"><i class="icon-help icon-white"></i></a>
                </div>
            </td>
            <td>
                <button class="btn btn-gray" onclick="btn_radio_3.setValue('gear');"><i class="icon-play"></i> Run</button>
            </td>
            <td>
                btn_radio_3.setValue("gear");
            </td>
            <td>
                해당 값의 버튼을 선택 상태로 변경
            </td>
        </tr>
    </table>
    </p>


</section>
<section>
    <h2>Check</h2>
    <p>
        버튼 컴포넌트는 다수를 선택할 수 있는 체크 타입을 제공합니다.

    <table class="table_s" cellpadding="0" cellspacing="0">
        <tr>
            <td width="170px">View</td>
            <td width="75px">Result</td>
            <td>Test Code</td>
            <td>Description</td>
        </tr>
        <tr>
            <td>
                <div id="btn_check" class="group">
                    <a class="btn mini" value="check"><i class="icon-check"></i></a>
                    <a class="btn mini" value="plus"><i class="icon-plus"></i></a>
                    <a class="btn mini" value="edit"><i class="icon-edit"></i></a>
                    <a class="btn mini" value="home"><i class="icon-home"></i></a>
                    <a class="btn mini" value="gear"><i class="icon-gear"></i></a>
                </div>
            </td>
            <td>
                <button class="btn btn-gray" onclick="btn_check.setIndex([ 3, 4 ]);"><i class="icon-play"></i> Run</button>
            </td>
            <td>
                btn_check.setIndex([ 3, 4 ]);
            </td>
            <td>
                해당 인덱스를 가지는 버튼들을 선택 상태로 변경
            </td>
        </tr>
        <tr>
            <td>
                <div id="btn_check_2" class="group">
                    <a class="btn mini" value="check"><i class="icon-check icon-white"></i></a>
                    <a class="btn mini" value="plus"><i class="icon-plus icon-white"></i></a>
                    <a class="btn mini" value="edit"><i class="icon-edit icon-white"></i></a>
                    <a class="btn mini" value="home"><i class="icon-home icon-white"></i></a>
                    <a class="btn mini" value="gear"><i class="icon-gear icon-white"></i></a>
                </div>
            </td>
            <td>
                <button class="btn btn-gray" onclick="btn_check_2.setValue([ 'check', 'edit' ]);"><i class="icon-play"></i> Run</button>
            </td>
            <td>
                btn_check_2.setValue([ 'check', 'edit' ]);
            </td>
            <td>
                해당 값을 가지는 버튼들을 선택 상태로 변경
            </td>
        </tr>
    </table>
    </p>
</section>
</body>
</html>